---
layout: layouts/base.njk
---
{% from "macros/article.njk" import article %}
{# Only include the syntax highlighter CSS on blog posts #}
{% css %}{% include "node_modules/prismjs/themes/prism-okaidia.css" %}{% endcss %}
{% css %}{% include "css/prism-diff.css" %}{% endcss %}
{# Auto-detect img-comparison-slider usage and include assets #}
{% if '<img-comparison-slider' in content %}
<link rel="stylesheet" href="/css/img-comparison-slider.css">
<script defer src="/js/img-comparison-slider.js"></script>
{% endif %}
<div class="h-entry">
<h2 class="p-name">{{ title }}</h2>

<ul class="post-metadata">
	<li><time class="dt-published" datetime="{{ page.date | htmlDateString }}">{{ page.date | readableDate }}</time></li>
	<li>{{ content | readingTime }}</li>
	{% for tag in tags | filterTagList %}
	{% set tagUrl %}/tags/{{ tag | slugify }}/{% endset %}
	<li><a href="{{ tagUrl }}" class="post-tag p-category">{{ tag }}</a>{% if not loop.last %}, {% endif %}</li>
	{% endfor %}
</ul>
<a class="u-url" href="{{ page.url }}" aria-hidden="true" tabindex="-1"></a>
<a class="p-author h-card" href="https://dwk.io">{{ metadata.author.name }}</a>

{% set toc = content | tableOfContents %}
{% if toc.length >= 3 %}
<nav class="toc" aria-labelledby="toc-heading">
	<h3 id="toc-heading">Table of Contents</h3>
	<ol>
	{% for item in toc %}
		<li class="toc-level-{{ item.level }}"><a href="#{{ item.id }}">{{ item.text }}</a></li>
	{% endfor %}
	</ol>
</nav>
{% endif %}

<article class="e-content">
  {{ article(page, content) }}
</article>
</div>

{% set related = tags | relatedPosts(page.url, collections.posts) %}
{% if related.length > 0 %}
<aside class="related-posts" aria-labelledby="related-heading">
	<h3 id="related-heading">Related Posts</h3>
	<ul>
	{% for post in related %}
		<li><a href="{{ post.url }}">{{ post.data.title }}</a></li>
	{% endfor %}
	</ul>
</aside>
{% endif %}

{% include "partials/webmentions.njk" %}

{% if collections.posts %}
  {% set previousPost = collections.posts | getPreviousCollectionItem %}
  {% set nextPost = collections.posts | getNextCollectionItem %}
  {% if nextPost or previousPost %}
    <nav aria-label="Post navigation">
    <ul class="links-nextprev">
	    {%- if previousPost %}<li>Previous: <a href="{{ previousPost.url }}">{{ previousPost.data.title }}</a></li>{% endif %}
	    {%- if nextPost %}<li>Next: <a href="{{ nextPost.url }}">{{ nextPost.data.title }}</a></li>{% endif %}
    </ul>
    </nav>
  {%- endif %}
{%- endif %}
