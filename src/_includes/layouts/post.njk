---
layout: layouts/base.njk
---
{% from "macros/article.njk" import article %}
{# Only include the syntax highlighter CSS on blog posts #}
{% css %}{% include "node_modules/prismjs/themes/prism-okaidia.css" %}{% endcss %}
{% css %}{% include "css/prism-diff.css" %}{% endcss %}
<h2>{{ title }}</h2>

<ul class="post-metadata">
	<li><time datetime="{{ page.date | htmlDateString }}">{{ page.date | readableDate }}</time></li>
	<li>{{ content | readingTime }}</li>
	{% for tag in tags | filterTagList %}
	{% set tagUrl %}/tags/{{ tag | slugify }}/{% endset %}
	<li><a href="{{ tagUrl }}" class="post-tag">{{ tag }}</a>{% if not loop.last %}, {% endif %}</li>
	{% endfor %}
</ul>

{% set toc = content | tableOfContents %}
{% if toc.length >= 3 %}
<nav class="toc" aria-labelledby="toc-heading">
	<h3 id="toc-heading">Table of Contents</h3>
	<ol>
	{% for item in toc %}
		<li class="toc-level-{{ item.level }}"><a href="#{{ item.id }}">{{ item.text }}</a></li>
	{% endfor %}
	</ol>
</nav>
{% endif %}

<article>
  {{ article(page, content) }}
</article>

{% set related = tags | relatedPosts(page.url, collections.posts) %}
{% if related.length > 0 %}
<aside class="related-posts" aria-labelledby="related-heading">
	<h3 id="related-heading">Related Posts</h3>
	<ul>
	{% for post in related %}
		<li><a href="{{ post.url }}">{{ post.data.title }}</a></li>
	{% endfor %}
	</ul>
</aside>
{% endif %}

{% if collections.posts %}
  {% set previousPost = collections.posts | getPreviousCollectionItem %}
  {% set nextPost = collections.posts | getNextCollectionItem %}
  {% if nextPost or previousPost %}
    <ul class="links-nextprev">
	    {%- if previousPost %}<li>Previous: <a href="{{ previousPost.url }}">{{ previousPost.data.title }}</a></li>{% endif %}
	    {%- if nextPost %}<li>Next: <a href="{{ nextPost.url }}">{{ nextPost.data.title }}</a></li>{% endif %}
    </ul>
  {%- endif %}
{%- endif %}
